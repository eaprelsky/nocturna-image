version: '3.8'

services:
  nginx:
    image: nginx:alpine
    container_name: nocturna-nginx
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro
      - nginx-logs:/var/log/nginx
    restart: unless-stopped
    depends_on:
      - chart-service-blue
      - chart-service-green
    networks:
      - nocturna-network
    labels:
      - "com.nocturna.service=nginx"
      - "com.nocturna.role=load-balancer"

volumes:
  nginx-logs:
    name: nocturna-nginx-logs

networks:
  nocturna-network:
    name: nocturna-network
    external: true  # Shared network across all Nocturna services
